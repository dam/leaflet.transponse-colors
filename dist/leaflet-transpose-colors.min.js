(function(n,l,p){function k(a){a=a.toString(16);return 1==a.length?"0"+a:a}function m(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,c,h){return b+b+c+c+h+h});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null}L.TileLayer.TransposeColors={};L.TileLayer.TransposeColors.version="0.0.1";L.TileLayer.TransposeColors.factory=L.TileLayer.extend({options:{enableCanvas:!0,transposeColors:[]},initialize:function(a,
e){var b=l.createElement("canvas");b.getContext&&b.getContext("2d")||(e.enableCanvas=!1);L.TileLayer.prototype.initialize.call(this,a,e)},_loadTile:function(a,e){a.setAttribute("crossorigin","anonymous");L.TileLayer.prototype._loadTile.call(this,a,e)},_tileOnLoad:function(){if(this._layer.options.enableCanvas&&!this.canvasContext){var a=l.createElement("canvas");a.width=a.height=this._layer.options.tileSize;this.canvasContext=a.getContext("2d")}if(a=this.canvasContext){this.onload=null;a.drawImage(this,
0,0);for(var e=a.getImageData(0,0,this._layer.options.tileSize,this._layer.options.tileSize),b=e.data,c=0,h=b.length;c<h;c+=4){var g=b[c+1],d=b[c+2];k(b[c]);k(g);k(d);for(g=0;g<this._layer.options.transposeColors.length;g++){var d=this._layer.options.transposeColors[g].rgbWindow,f=m(this._layer.options.transposeColors[g].from);b[c]>=f.r-d&&b[c]<=f.r+d&&b[c+1]>=f.g-d&&b[c+1]<=f.g+d&&b[c+2]>=f.b-d&&b[c+2]<=f.b+d&&(d=m(this._layer.options.transposeColors[g].to),f=this._layer.options.transposeColors[g].alpha,
b[c]=d.r,b[c+1]=d.g,b[c+2]=d.b,f&&(b[c+3]=f))}}a.putImageData(e,0,0);this.removeAttribute("crossorigin");this.src=a.canvas.toDataURL()}L.TileLayer.prototype._tileOnLoad.call(this)}});L.TileLayer.transposeColors=function(a,e){return new L.TileLayer.TransposeColors.factory(a,e)}})(this,document);
